이번 장에서는 모듈 시스템과, 새로운 자바 모듈 시스템이 어디에 이용되며, 이로 인해 얻는 이익을 설명한다. 모듈 시스템은 한 권의 책으로 써야 할 만큼 복잡한 주제이기 때문에, 이번 책에서는 넓게 다룬다고 한다.

# 14.1 압력 : 소프트웨어 유추

## 14.1.1 관심사 분리

관심사 분리는 컴퓨터 프로그램을 고유의 기능으로 나누는 동작을 권장하는 원칙이다.

SoC 원칙은 모델, 뷰, 컨트롤러 같은 아키텍처 관점, 그리고 복구 기법을 비즈니스 로직과 분리하는 등에 유용하다.

- 개별 기능을 따로 작업할 수 있다. 협업이 쉽다.
- 개별 부분을 재사용하기 쉽다.
- 전체 시스템 유지보수가 쉽다.

## 14.1.2 정보 은닉

세부 구현을 숨기도록 장려하는 원칙이다. 세부 구현을 숨기면, 프로그램의 어떤 부분을 바꿨을 때 다른 부분까지 영향을 미칠 가능성을 줄여준다. 

### 캡슐화

캡슐화란, 특정 코드 조각이 애플리케이션의 다른 부분과 고립되어 있음을 의미한다. 자바에서는 클래스 내의 컴포넌트에 `private` 키워드를 사용했는지를 기준으로 컴파일러를 이용해 캡슐화를 확인할 수 있다고 한다.

# 14.2 자바 모듈 시스템을 설계한 이유

## 14.2.1 모듈화의 한계

자바 9 이전까지는 모듈화 소프트웨어 프로젝트를 만드는 데 한계가 있었다고 한다. 자바는 클래스, 패키지, JAR 세 가지 수준의 코드 그룹화를 제공한다. 클래스와 관련해서 자바는 접근 제한자와 캡슐화를 지원했지만, 패키지와 JAR 수준에서는 캡슐화를 거의 지원하지 않았다.

### 제한된 가시성 제어

패키지의 가시성 제어 기능은 거의 없는 수준이다. public으로 선언한 결과, 이들은 공개되며 결국 위험하다.

### 클래스 경로

클래스를 모두 컴파일한 다음, JAR 파일에 넣고 클래스 경로에 이 JAR 파일을 추가해 사용할 수 있다.

하지만 클래스 경로와 JAR 조합에는 약점이 있다.

1. 클래스 경로에는 같은 클래스를 구분하는 버전 개념이 없다. 같은 클래스 경로에 같은 두 가지 버전의 라이브러리가 존재한다면 어떤 일이 일어날지 모른다.
2. 클래스 경로는 명시적인 의존성을 지원하지 않는다.

하지만 이런 문제는 자바 9 모듈 시스템을 이용하면 발생하는 에러를 검출할 수 있다고 한다.

다음은 JDK 쪽 문제이다.

## 14.2.2 거대한 JDK

자바 개발 키트는 자바 프로그램을 만들고 실행하는 데 도움을 주는 도구의 집합이다.

여러 문제 때문에, JDK 자체도 모듈화할 수 있는 자바 모듈 시스템 설계의 필요성이 제기된다. 즉, JDK 에서 필요한 부분만 골라 사용하고, 클래스 경로를 쉽게 유추할 수 있는 새로운 건축 구조가 필요하다.

## 14.2.3 OSGi와 비교

OSGi 를 들어본 적이 없는 독자는 이 절을 스킵해도 된다.

스킵하겠다.

# 14.3 자바 모듈 : 큰 그림

자바 8은 모듈이라는 새로운 자바 프로그램 구조 단위를 제공한다.

모듈은 module 이라는 새 키워드에 이름과 바디를 추가해서 정의한다. 모듈 디스크립터라는 특별한 파일에 저장된다.

![image](https://user-images.githubusercontent.com/92802207/216065529-2cea550a-ac8d-41fd-8c34-8bfe4dea8fc0.png)

![image](https://user-images.githubusercontent.com/92802207/216065492-3fb47aee-1fce-47cb-9c54-16161324b22e.png)

메이븐, 그레들 같은 도구를 사용할 때 모듈의 많은 세부 사항을 IDE가 처리해서 사용자에게는 잘 들어나지 않는다고 한다.

# 14.4 자바 모듈 시스템으로 애플리케이션 개발하기

## 14.4.1 애플리케이션 셋업

비용 관리 애플리케이션을 만든다고 하자. 다음의 작업을 처리한다고 하자.

- 파일이나 URL에서 비용 목록을 읽는다.
- 비용의 문자열 표현을 파싱한다.
- 통계를 계산한다.
- 유용한 요약 정보를 표시한다.
- 각 태스크의 시작, 마무리 지점을 제공한다.

이제 어떻게 모듈화를 해야할까? 우선 다음과 같은 분리 할 수 있는 관심사들이 있다.

- 다양한 소스에서 데이터를 읽음
- 다양한 포맷으로 구성된 데이터를 파싱
- 도메인 객체를 구체화
- 통계를 계산하고 반환
- 다양한 기능을 분리 조정

처음에는 아주 작은 기능까지 캡슐화하는 것이 장점에 비해서 초기 비용도 높고, 옳은 결정인지 헷갈릴 때가 있다. 하지만 프로젝트가 점점 커지면서 많은 내부 구현이 추가되면, 이때부터 캡슐화와 추론의 장점이 두드러진다.

## 14.4.2 세부적인 모듈화와 거친 모듈화

세부적인 모듈화 기법 

- 모든 패키지가 자신의 모듈을 갖는다.
- 이득에 비해 설계 비용이 증가한다.

거친 모듈화 기법 

- 한 모듈이 시스템의 모든 패키지를 포함한다.
- 모듈화의 모든 장점을 잃는다.

주기적으로 확인하면서 적절하게 모듈화되어 있는지 확인하는 것이 가장 좋다.
